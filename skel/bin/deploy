#!/usr/bin/env bash

type greadlink >/dev/null 2>&1 && CWD="$(dirname "$(greadlink -f "$0")")" || \
  CWD="$(dirname "$(readlink -f "$0")")"

# globals
#########

CMD_HELP_PREFIX="A utility for deploying to an environment.

  Usage: deploy <environment>
"

ANSIBLE_PLAYBOOK="deploy.yml"
FORCE_ENVIRONMENT_PLAYBOOK=true


# runtime
#########

. $CWD/.functions.sh || error "unable to load shared functions"

# @TODO only fail if deployment requires local compilation -- how to determine??
fail_in_groundcontrol "bin/deploy"

ansible_command $@

exit $?
